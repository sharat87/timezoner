const DEFAULT_ZONES=["Asia/Kolkata","America/New_York","Europe/Amsterdam"],zonesEl=document.getElementById("zones"),settingsFormEl=document.forms.settingsForm;function roundedTo15(e){if(e instanceof moment){const t=e.second(0).minute()%15;return t>=8&&e.add(15,"m"),e.subtract(t,"m")}{const t=(e=Math.round(parseFloat(e)))%15;return t>=8&&(e+=15),e-t}}function getMomentInZoneBox(e){return moment.tz([e.year.value,e.month.value,e.date.value,e.hour.value,e.minute.value,e.meridian.value].join(" "),"YYYY MM DD hh mm A",e.dataset.zone)}function setMomentInZoneBox(e,t,n){const[s,o,i,a,r,l,u,c]=t.format("YYYY MM DD hh mm A zz ZZ").split(" ");n&&n.includes(e.year)||(e.year.value=s),n&&n.includes(e.month)||(e.month.value=o),n&&n.includes(e.date)||(e.date.value=i),n&&n.includes(e.hour)||(e.hour.value=a),n&&n.includes(e.minute)||(e.minute.value=r),n&&n.includes(e.meridian)||(e.meridian.value=l),e.querySelector(".tz-abbr").innerHTML=u==e.dataset.zone?"":u+" = UTC"+c}function saveZones(){const e=[];for(const t of zonesEl.children)e.push(t.dataset.zone);localStorage.setItem("zones",JSON.stringify(e.slice(1)))}function loadZones(){const e=localStorage.getItem("zones");if(!e)return DEFAULT_ZONES;const t=JSON.parse(e);return t&&0!==t.length?t:DEFAULT_ZONES}function loadAllTimeZones(){const e=moment.tz.names();for(let t=e.length;t-- >0;)e[t]='<option value="'+e[t]+'">';document.getElementById("zoneNames").innerHTML=e.join("")}let h;function main(){h=hyperapp.h;const{app:e}=hyperapp;function t(e){return""!==e.inputValue?{...e,cities:[...e.cities,e.inputValue],inputValue:""}:e}window.ha=e({init:[{currentUtc:null,cities:["Mumbai","London","New York","Sydney"],zonesByCity:new Map,timesByZone:new Map,inputValue:""},[loadCities]],node:document.getElementById("app"),view:e=>h("div",{},[h("h1",{},"~ Timezoner ~ "),h("section",{},[h("div",{},zoneDisplayForCity(e)),h("input",{value:e.inputValue,onkeydown:(e,n)=>"Enter"===n.key?t(e):e,oninput:(e,t)=>({...e,inputValue:t.target.value})}),h("button",{onclick:t},"add")])])})}function loadCities(e){fetch("cities5000.txt").then(e=>e.text()).then(t=>{const n=new Map,s=t.split("\n").slice(2);for(const e of s)if(e){const[t,s,o]=e.split("\t");n.set(t,{name:t,asciiName:s,timezone:o,lowerName:s.toLowerCase()})}e(e=>({...e,zonesByCity:n}))})}function zoneDisplayForCity(e){return e.cities.map(t=>{const n=e.zonesByCity.get(t);if(!n)return"";const s=e.timesByZone.get(n.timezones);return h("form",{class:"zone","data-zone":n.timezone},[h("div",{class:"name"},t)," - ",n?n.timezone:"No zone"," - ",h("input",{class:"num",required:!0,name:"year",value:s.year}),"-",h("input",{class:"num",required:!0,name:"month",value:s.month}),"-",h("input",{class:"num",required:!0,name:"date",value:s.date}),"  ",h("input",{class:"num",required:!0,name:"hour",value:s.hour}),":",h("input",{class:"num",required:!0,name:"minute",value:s.minute})," ",h("input",{class:"num",required:!0,name:"meridian",value:s.meridian})])})}window.addEventListener("load",()=>{let e=roundedTo15(moment.utc()),t=0;const n=e.clone();zonesEl.addEventListener("input",o),zonesEl.addEventListener("click",(function(e){const t=e.target.closest(".dot");t&&(t.closest(".zone").remove(),saveZones())})),zonesEl.addEventListener("keydown",(function(e){if(["ArrowUp","ArrowDown"].includes(e.key)&&e.target.classList.contains("num"))e.preventDefault(),r(e.target,"ArrowUp"===e.key?1:-1);else if(["ArrowLeft","ArrowRight"].includes(e.key)&&e.target.classList.contains("num")){const t=e.target.selectionStart;if(0===t&&"ArrowLeft"===e.key){let t=e.target.previousElementSibling;for(;!t.matches("input.num");){if(!t.previousElementSibling)return;t=t.previousElementSibling}t.focus(),t.selectionStart=t.value.length,e.preventDefault()}else if(t===e.target.value.length&&"ArrowRight"===e.key){let t=e.target.nextElementSibling;for(;!t.matches("input.num");){if(!t.nextElementSibling)return;t=t.nextElementSibling}t.focus(),t.selectionEnd=0,e.preventDefault()}}})),zonesEl.addEventListener("wheel",(function(e){e.target.classList.contains("num")&&(e.preventDefault(),r(e.target,-Math.sign(e.deltaY)))})),document.forms.addZoneForm.addEventListener("submit",(function(e){e.preventDefault();const t=e.target.querySelector("input"),n=t.value;null===moment.tz.zone(n)?t.classList.add("error"):(t.classList.remove("error"),t.value="",s(n),saveZones())})),settingsFormEl.addEventListener("input",l),s("UTC");for(const e of loadZones())s(e);function s(e){const t=moment.tz.guess()===e?"local":"";let n="",s=e;e.includes("/")&&([n,s]=e.split("/",2)),s=s.replace(/_/g," "),zonesEl.insertAdjacentHTML("beforeEnd",`\n\t\t\t<form class="zone ${t}" data-zone="${e}">\n\t\t\t\t<svg class="dot">\n\t\t\t\t\t<g>\n\t\t\t\t\t\t<circle r="45%" cx="50%" cy="50%" stroke-width="0"/>\n\t\t\t\t\t\t<line x1="25%" y1="50%" x2="75%" y2="50%" stroke-width="2" stroke="white" display="none"/>\n\t\t\t\t\t</g>\n\t\t\t\t</svg>\n\t\t\t\t<div class=name>\n\t\t\t\t\t<span><span class=continent>${n}</span><span class=city>${s}</span></span>\n\t\t\t\t\t<span class=tz-abbr></span>\n\t\t\t\t</div>\n\t\t\t\t<input class="num" required name="year">\n\t\t\t\t<span class="sep">&ndash;</span>\n\t\t\t\t<input class="num" required name="month">\n\t\t\t\t<span class="sep">&ndash;</span>\n\t\t\t\t<input class="num" required name="date">\n\t\t\t\t<span class="sep">&middot;</span>\n\t\t\t\t<input class="num" required name="hour">\n\t\t\t\t<span class="sep">:</span>\n\t\t\t\t<input class="num" required name="minute">\n\t\t\t\t<span class="sep">&nbsp;</span>\n\t\t\t\t<input class="num" required name="meridian">\n\t\t\t</form>\n\t\t`.trim()),a(zonesEl.lastElementChild)}function o(s){let o;s instanceof Event?o=s.target:s instanceof Element&&(o=s,s=null);const a=getMomentInZoneBox(o.closest(".zone"));"range"===o.type?(t=o.value-a.utcOffset(),e=n.clone().add(t,"m")):(e=a.utc(),t=e.diff(n,"m")),i({exceptInputs:[o]})}function i(e){const{exceptZone:t,exceptInputs:n}=e||{};for(const e of zonesEl.children)e!==t&&a(e,n)}function a(n,s){const o=e.tz(n.dataset.zone);setMomentInZoneBox(n,o,s);const i=n.querySelector('input[type="range"]');!i||s&&s.includes(i)||(i.value=t+o.utcOffset())}function r(e,t){const n=e.closest(".zone"),s=getMomentInZoneBox(n);let i=e.name,a=1;"meridian"===i?[a,i]=[12,"h"]:"minute"===i?a=15:"date"===i&&(i="d"),s.add(t*a,i),setMomentInZoneBox(n,roundedTo15(s)),o(e)}function l(){settingsFormEl.hideSliders&&settingsFormEl.hideSliders.checked?document.body.classList.add("hide-sliders"):document.body.classList.remove("hide-sliders")}document.getElementById("loadingBox").remove(),i(),loadAllTimeZones(),l(),document.body.addEventListener("keydown",(function(e){if(!e.target.matches("input.zone-input"))return;if("ArrowUp"===e.key){const t=e.target.previousElementSibling.querySelector(".active");t.previousElementSibling&&(t.classList.remove("active"),t.previousElementSibling.classList.add("active"))}else if("ArrowDown"===e.key){const t=e.target.nextElementSibling.querySelector(".active");t.nextElementSibling&&(t.classList.remove("active"),t.nextElementSibling.classList.add("active"))}else if("Enter"===e.key){d(e.target.nextElementSibling.querySelector(".active"))}else setTimeout((function t(){const n=++m,s=e.target.value.toLowerCase();if(""===s)return;const o=[];setTimeout(t);const i=[];for(const e of u)if(e.lowerName.includes(s)&&(i.push(e),o.push(`<a href=# data-timezone="${e.timezone}" class="${o.length?"":"active"}">${e.name}</a>`)),n!==m)return void console.log("Cancel search",n);n===m&&(c=i,e.target.nextElementSibling.innerHTML=o.join(""))}))})),document.body.addEventListener("click",e=>{"#"===e.target.getAttribute("href")&&e.target.dataset.timezone&&(e.preventDefault(),d(e.target))});const u=[];let c=[],m=0;function d(e){s(e.dataset.timezone),saveZones()}fetch("cities5000.txt").then(e=>e.text()).then(e=>{const t=e.split("\n").slice(2);for(const e of t){if(!e)continue;const[t,n,s]=e.split("\t");u.push({name:t,asciiName:n,timezone:s,lowerName:n.toLowerCase()})}})}),window.onload=main;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImhhcHAuanMiXSwibmFtZXMiOlsiREVGQVVMVF9aT05FUyIsInpvbmVzRWwiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwic2V0dGluZ3NGb3JtRWwiLCJmb3JtcyIsInNldHRpbmdzRm9ybSIsInJvdW5kZWRUbzE1IiwibXQiLCJtb21lbnQiLCJtb2QiLCJzZWNvbmQiLCJtaW51dGUiLCJhZGQiLCJzdWJ0cmFjdCIsIk1hdGgiLCJyb3VuZCIsInBhcnNlRmxvYXQiLCJnZXRNb21lbnRJblpvbmVCb3giLCJ6b25lRWwiLCJ0eiIsInllYXIiLCJ2YWx1ZSIsIm1vbnRoIiwiZGF0ZSIsImhvdXIiLCJtZXJpZGlhbiIsImpvaW4iLCJkYXRhc2V0Iiwiem9uZSIsInNldE1vbWVudEluWm9uZUJveCIsImV4Y2VwdElucHV0cyIsImFiYnIiLCJvZmZzZXQiLCJmb3JtYXQiLCJzcGxpdCIsImluY2x1ZGVzIiwicXVlcnlTZWxlY3RvciIsImlubmVySFRNTCIsInNhdmVab25lcyIsIm5hbWVzIiwiZWwiLCJjaGlsZHJlbiIsInB1c2giLCJsb2NhbFN0b3JhZ2UiLCJzZXRJdGVtIiwiSlNPTiIsInN0cmluZ2lmeSIsInNsaWNlIiwibG9hZFpvbmVzIiwic3RvcmFnZSIsImdldEl0ZW0iLCJwYXJzZSIsImxlbmd0aCIsImxvYWRBbGxUaW1lWm9uZXMiLCJpIiwiaCIsIm1haW4iLCJoeXBlcmFwcCIsImFwcCIsInN0YXRlIiwiaW5wdXRWYWx1ZSIsImNpdGllcyIsIndpbmRvdyIsImhhIiwiaW5pdCIsImN1cnJlbnRVdGMiLCJ6b25lc0J5Q2l0eSIsIk1hcCIsInRpbWVzQnlab25lIiwibG9hZENpdGllcyIsIm5vZGUiLCJ2aWV3Iiwiem9uZURpc3BsYXlGb3JDaXR5Iiwib25rZXlkb3duIiwiZXZlbnQiLCJrZXkiLCJvbmlucHV0IiwidGFyZ2V0Iiwib25jbGljayIsImRpc3BhdGNoIiwiZmV0Y2giLCJ0aGVuIiwicmVzcG9uc2UiLCJ0ZXh0IiwiY29udGVudCIsImxpbmVzIiwibGluZSIsIm5hbWUiLCJhc2NpaU5hbWUiLCJ0aW1lem9uZSIsInNldCIsImxvd2VyTmFtZSIsInRvTG93ZXJDYXNlIiwibWFwIiwiZ2V0IiwidGltZSIsInRpbWV6b25lcyIsImNsYXNzIiwiZGF0YS16b25lIiwicmVxdWlyZWQiLCJhZGRFdmVudExpc3RlbmVyIiwidXRjIiwiY3VycmVudE9mZnNldCIsIm1pZFV0YyIsImNsb25lIiwib25UaW1lQ2hhbmdlZCIsImRvdEVsIiwiY2xvc2VzdCIsInJlbW92ZSIsImNsYXNzTGlzdCIsImNvbnRhaW5zIiwicHJldmVudERlZmF1bHQiLCJtb2RpZnlJbnB1dCIsInBvaW50Iiwic2VsZWN0aW9uU3RhcnQiLCJkc3QiLCJwcmV2aW91c0VsZW1lbnRTaWJsaW5nIiwibWF0Y2hlcyIsImZvY3VzIiwibmV4dEVsZW1lbnRTaWJsaW5nIiwic2VsZWN0aW9uRW5kIiwic2lnbiIsImRlbHRhWSIsImFkZFpvbmVGb3JtIiwiaW5wdXQiLCJhZGRab25lIiwiYXBwbHlTZXR0aW5ncyIsImxvY2FsQ2xhc3MiLCJndWVzcyIsImNvbnRpbmVudCIsImNpdHkiLCJyZXBsYWNlIiwiaW5zZXJ0QWRqYWNlbnRIVE1MIiwidHJpbSIsInVwZGF0ZVpvbmUiLCJsYXN0RWxlbWVudENoaWxkIiwiRXZlbnQiLCJFbGVtZW50IiwidHlwZSIsInV0Y09mZnNldCIsImRpZmYiLCJ1cGRhdGVBbGxab25lcyIsImRhdGEiLCJleGNlcHRab25lIiwicmFuZ2VJbnB1dCIsImlucHV0RWwiLCJkaXJlY3Rpb24iLCJ1bml0IiwiY291bnQiLCJoaWRlU2xpZGVycyIsImNoZWNrZWQiLCJib2R5IiwiYWN0aXZlRWwiLCJhZGRUaW1lWmVuZUZyb21MaW5rIiwic2V0VGltZW91dCIsImRvU2VhcmNoIiwidGhpc1NlYXJjaElkIiwic2VhcmNoSWQiLCJuZWVkbGUiLCJyZXN1bHRzIiwiaXRlbSIsImNpdHlEYXRhIiwiY29uc29sZSIsImxvZyIsInByZXZSZXN1bHRzIiwi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OlsiLypcbiAqIFRPRE86XG4gKlx0UmVwcmVzZW50IGRheS9uaWdodCBmb3IgZWFjaCB0aW1lem9uZS5cbiAqXHRGdXp6eSBzZWFyY2hpbmcgb2YgdGltZXpvbmVzIHdoZW4gYWRkaW5nLlxuICovXG5cbi8vIGltcG9ydCBtb21lbnQgZnJvbSBcIm1vbWVudC10aW1lem9uZVwiOyAgLy8gRm9yIHVzZSB3aXRoIFJvbGxVcCBidW5kbGVyLlxuXG5jb25zdCBERUZBVUxUX1pPTkVTID0gWydBc2lhL0tvbGthdGEnLCAnQW1lcmljYS9OZXdfWW9yaycsICdFdXJvcGUvQW1zdGVyZGFtJ107XG5jb25zdCB6b25lc0VsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3pvbmVzJyksXG5cdHNldHRpbmdzRm9ybUVsID0gZG9jdW1lbnQuZm9ybXMuc2V0dGluZ3NGb3JtO1xuXG53aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsICgpID0+IHtcblx0bGV0IGN1cnJlbnRVdGMgPSByb3VuZGVkVG8xNShtb21lbnQudXRjKCkpO1xuXHRsZXQgY3VycmVudE9mZnNldCA9IDA7XG5cdGNvbnN0IG1pZFV0YyA9IGN1cnJlbnRVdGMuY2xvbmUoKTtcblxuXHR6b25lc0VsLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0Jywgb25UaW1lQ2hhbmdlZCk7XG5cdHpvbmVzRWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvblpvbmVDbGlja2VkKTtcblx0em9uZXNFbC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgb25ab25lS2V5ZG93bik7XG5cdHpvbmVzRWwuYWRkRXZlbnRMaXN0ZW5lcignd2hlZWwnLCBvblpvbmVXaGVlbCk7XG5cdGRvY3VtZW50LmZvcm1zLmFkZFpvbmVGb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIG9uQWRkRm9ybVN1Ym1pdCk7XG5cdHNldHRpbmdzRm9ybUVsLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgYXBwbHlTZXR0aW5ncyk7XG5cblx0YWRkWm9uZSgnVVRDJyk7XG5cdGZvciAoY29uc3QgbmFtZSBvZiBsb2FkWm9uZXMoKSlcblx0XHRhZGRab25lKG5hbWUpO1xuXG5cdGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2FkaW5nQm94JykucmVtb3ZlKCk7XG5cdHVwZGF0ZUFsbFpvbmVzKCk7XG5cdGxvYWRBbGxUaW1lWm9uZXMoKTtcblx0YXBwbHlTZXR0aW5ncygpO1xuXG5cdGZ1bmN0aW9uIGFkZFpvbmUobmFtZSkge1xuXHRcdGNvbnN0IGxvY2FsQ2xhc3MgPSBtb21lbnQudHouZ3Vlc3MoKSA9PT0gbmFtZSA/ICdsb2NhbCcgOiAnJztcblxuXHRcdGxldCBjb250aW5lbnQgPSAnJywgY2l0eSA9IG5hbWU7XG5cdFx0aWYgKG5hbWUuaW5jbHVkZXMoJy8nKSlcblx0XHRcdFtjb250aW5lbnQsIGNpdHldID0gbmFtZS5zcGxpdCgnLycsIDIpO1xuXHRcdGNpdHkgPSBjaXR5LnJlcGxhY2UoL18vZywgJyAnKTtcblxuXHRcdHpvbmVzRWwuaW5zZXJ0QWRqYWNlbnRIVE1MKCdiZWZvcmVFbmQnLCBgXG5cdFx0XHQ8Zm9ybSBjbGFzcz1cInpvbmUgJHtsb2NhbENsYXNzfVwiIGRhdGEtem9uZT1cIiR7bmFtZX1cIj5cblx0XHRcdFx0PHN2ZyBjbGFzcz1cImRvdFwiPlxuXHRcdFx0XHRcdDxnPlxuXHRcdFx0XHRcdFx0PGNpcmNsZSByPVwiNDUlXCIgY3g9XCI1MCVcIiBjeT1cIjUwJVwiIHN0cm9rZS13aWR0aD1cIjBcIi8+XG5cdFx0XHRcdFx0XHQ8bGluZSB4MT1cIjI1JVwiIHkxPVwiNTAlXCIgeDI9XCI3NSVcIiB5Mj1cIjUwJVwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2U9XCJ3aGl0ZVwiIGRpc3BsYXk9XCJub25lXCIvPlxuXHRcdFx0XHRcdDwvZz5cblx0XHRcdFx0PC9zdmc+XG5cdFx0XHRcdDxkaXYgY2xhc3M9bmFtZT5cblx0XHRcdFx0XHQ8c3Bhbj48c3BhbiBjbGFzcz1jb250aW5lbnQ+JHtjb250aW5lbnR9PC9zcGFuPjxzcGFuIGNsYXNzPWNpdHk+JHtjaXR5fTwvc3Bhbj48L3NwYW4+XG5cdFx0XHRcdFx0PHNwYW4gY2xhc3M9dHotYWJicj48L3NwYW4+XG5cdFx0XHRcdDwvZGl2PlxuXHRcdFx0XHQ8aW5wdXQgY2xhc3M9XCJudW1cIiByZXF1aXJlZCBuYW1lPVwieWVhclwiPlxuXHRcdFx0XHQ8c3BhbiBjbGFzcz1cInNlcFwiPiZuZGFzaDs8L3NwYW4+XG5cdFx0XHRcdDxpbnB1dCBjbGFzcz1cIm51bVwiIHJlcXVpcmVkIG5hbWU9XCJtb250aFwiPlxuXHRcdFx0XHQ8c3BhbiBjbGFzcz1cInNlcFwiPiZuZGFzaDs8L3NwYW4+XG5cdFx0XHRcdDxpbnB1dCBjbGFzcz1cIm51bVwiIHJlcXVpcmVkIG5hbWU9XCJkYXRlXCI+XG5cdFx0XHRcdDxzcGFuIGNsYXNzPVwic2VwXCI+Jm1pZGRvdDs8L3NwYW4+XG5cdFx0XHRcdDxpbnB1dCBjbGFzcz1cIm51bVwiIHJlcXVpcmVkIG5hbWU9XCJob3VyXCI+XG5cdFx0XHRcdDxzcGFuIGNsYXNzPVwic2VwXCI+Ojwvc3Bhbj5cblx0XHRcdFx0PGlucHV0IGNsYXNzPVwibnVtXCIgcmVxdWlyZWQgbmFtZT1cIm1pbnV0ZVwiPlxuXHRcdFx0XHQ8c3BhbiBjbGFzcz1cInNlcFwiPiZuYnNwOzwvc3Bhbj5cblx0XHRcdFx0PGlucHV0IGNsYXNzPVwibnVtXCIgcmVxdWlyZWQgbmFtZT1cIm1lcmlkaWFuXCI+XG5cdFx0XHQ8L2Zvcm0+XG5cdFx0YC50cmltKCkpO1xuXHRcdHVwZGF0ZVpvbmUoem9uZXNFbC5sYXN0RWxlbWVudENoaWxkKTtcblx0fVxuXG5cdGZ1bmN0aW9uIG9uVGltZUNoYW5nZWQoZXZlbnQpIHtcblx0XHRsZXQgdGFyZ2V0O1xuXHRcdGlmIChldmVudCBpbnN0YW5jZW9mIEV2ZW50KSB7XG5cdFx0XHR0YXJnZXQgPSBldmVudC50YXJnZXQ7XG5cdFx0fSBlbHNlIGlmIChldmVudCBpbnN0YW5jZW9mIEVsZW1lbnQpIHtcblx0XHRcdHRhcmdldCA9IGV2ZW50O1xuXHRcdFx0ZXZlbnQgPSBudWxsO1xuXHRcdH1cblxuXHRcdGNvbnN0IG10ID0gZ2V0TW9tZW50SW5ab25lQm94KHRhcmdldC5jbG9zZXN0KCcuem9uZScpKTtcblx0XHRpZiAodGFyZ2V0LnR5cGUgPT09ICdyYW5nZScpIHtcblx0XHRcdGN1cnJlbnRPZmZzZXQgPSB0YXJnZXQudmFsdWUgLSBtdC51dGNPZmZzZXQoKTtcblx0XHRcdGN1cnJlbnRVdGMgPSBtaWRVdGMuY2xvbmUoKS5hZGQoY3VycmVudE9mZnNldCwgJ20nKTtcblxuXHRcdH0gZWxzZSB7XG5cdFx0XHRjdXJyZW50VXRjID0gbXQudXRjKCk7XG5cdFx0XHRjdXJyZW50T2Zmc2V0ID0gY3VycmVudFV0Yy5kaWZmKG1pZFV0YywgJ20nKTtcblxuXHRcdH1cblxuXHRcdHVwZGF0ZUFsbFpvbmVzKHtleGNlcHRJbnB1dHM6IFt0YXJnZXRdfSk7XG5cdH1cblxuXHRmdW5jdGlvbiB1cGRhdGVBbGxab25lcyhkYXRhKSB7XG5cdFx0Y29uc3Qge2V4Y2VwdFpvbmUsIGV4Y2VwdElucHV0c30gPSBkYXRhIHx8IHt9O1xuXHRcdGZvciAoY29uc3QgZWwgb2Ygem9uZXNFbC5jaGlsZHJlbilcblx0XHRcdGlmIChlbCAhPT0gZXhjZXB0Wm9uZSlcblx0XHRcdFx0dXBkYXRlWm9uZShlbCwgZXhjZXB0SW5wdXRzKTtcblx0fVxuXG5cdGZ1bmN0aW9uIHVwZGF0ZVpvbmUoem9uZUVsLCBleGNlcHRJbnB1dHMpIHtcblx0XHRjb25zdCBtdCA9IGN1cnJlbnRVdGMudHooem9uZUVsLmRhdGFzZXQuem9uZSk7XG5cdFx0c2V0TW9tZW50SW5ab25lQm94KHpvbmVFbCwgbXQsIGV4Y2VwdElucHV0cyk7XG5cblx0XHRjb25zdCByYW5nZUlucHV0ID0gem9uZUVsLnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W3R5cGU9XCJyYW5nZVwiXScpO1xuXHRcdGlmIChyYW5nZUlucHV0ICYmICghZXhjZXB0SW5wdXRzIHx8ICFleGNlcHRJbnB1dHMuaW5jbHVkZXMocmFuZ2VJbnB1dCkpKVxuXHRcdFx0cmFuZ2VJbnB1dC52YWx1ZSA9IGN1cnJlbnRPZmZzZXQgKyBtdC51dGNPZmZzZXQoKTtcblx0fVxuXG5cdGZ1bmN0aW9uIG9uQWRkRm9ybVN1Ym1pdChldmVudCkge1xuXHRcdGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cdFx0Y29uc3QgaW5wdXQgPSBldmVudC50YXJnZXQucXVlcnlTZWxlY3RvcignaW5wdXQnKTtcblx0XHRjb25zdCBuYW1lID0gaW5wdXQudmFsdWU7XG5cdFx0aWYgKG1vbWVudC50ei56b25lKG5hbWUpID09PSBudWxsKSB7XG5cdFx0XHRpbnB1dC5jbGFzc0xpc3QuYWRkKCdlcnJvcicpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRpbnB1dC5jbGFzc0xpc3QucmVtb3ZlKCdlcnJvcicpO1xuXHRcdFx0aW5wdXQudmFsdWUgPSAnJztcblx0XHRcdGFkZFpvbmUobmFtZSk7XG5cdFx0XHRzYXZlWm9uZXMoKTtcblx0XHR9XG5cdH1cblxuXHRmdW5jdGlvbiBvblpvbmVDbGlja2VkKGV2ZW50KSB7XG5cdFx0Y29uc3QgZG90RWwgPSBldmVudC50YXJnZXQuY2xvc2VzdCgnLmRvdCcpO1xuXHRcdGlmIChkb3RFbCkge1xuXHRcdFx0ZG90RWwuY2xvc2VzdCgnLnpvbmUnKS5yZW1vdmUoKTtcblx0XHRcdHNhdmVab25lcygpO1xuXHRcdH1cblx0fVxuXG5cdGZ1bmN0aW9uIG1vZGlmeUlucHV0KGlucHV0RWwsIGRpcmVjdGlvbikge1xuXHRcdC8vIGlucHV0RWwgc2hvdWxkIGJlIGFuIGlucHV0Lm51bSBlbGVtZW50LlxuXHRcdC8vIGRpcmVjdGlvbiBzaG91bGQgYmUgLTEgb3IgMS5cblx0XHRjb25zdCB6b25lRWwgPSBpbnB1dEVsLmNsb3Nlc3QoJy56b25lJyk7XG5cdFx0Y29uc3QgbXQgPSBnZXRNb21lbnRJblpvbmVCb3goem9uZUVsKTtcblx0XHRsZXQgdW5pdCA9IGlucHV0RWwubmFtZTtcblx0XHRsZXQgY291bnQgPSAxO1xuXG5cdFx0aWYgKHVuaXQgPT09ICdtZXJpZGlhbicpXG5cdFx0XHRbY291bnQsIHVuaXRdID0gWzEyLCAnaCddO1xuXHRcdGVsc2UgaWYgKHVuaXQgPT09ICdtaW51dGUnKVxuXHRcdFx0Y291bnQgPSAxNTtcblx0XHRlbHNlIGlmICh1bml0ID09PSAnZGF0ZScpXG5cdFx0XHR1bml0ID0gJ2QnO1xuXG5cdFx0bXQuYWRkKGRpcmVjdGlvbiAqIGNvdW50LCB1bml0KTtcblx0XHRzZXRNb21lbnRJblpvbmVCb3goem9uZUVsLCByb3VuZGVkVG8xNShtdCkpO1xuXHRcdG9uVGltZUNoYW5nZWQoaW5wdXRFbCk7XG5cdH1cblxuXHRmdW5jdGlvbiBvblpvbmVLZXlkb3duKGV2ZW50KSB7XG5cdFx0aWYgKFsnQXJyb3dVcCcsICdBcnJvd0Rvd24nXS5pbmNsdWRlcyhldmVudC5rZXkpICYmIGV2ZW50LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ251bScpKSB7XG5cdFx0XHRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0bW9kaWZ5SW5wdXQoZXZlbnQudGFyZ2V0LCBldmVudC5rZXkgPT09ICdBcnJvd1VwJyA/IDEgOiAtMSk7XG5cblx0XHR9IGVsc2UgaWYgKFsnQXJyb3dMZWZ0JywgJ0Fycm93UmlnaHQnXS5pbmNsdWRlcyhldmVudC5rZXkpICYmIGV2ZW50LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ251bScpKSB7XG5cdFx0XHRjb25zdCBwb2ludCA9IGV2ZW50LnRhcmdldC5zZWxlY3Rpb25TdGFydDtcblx0XHRcdGlmIChwb2ludCA9PT0gMCAmJiBldmVudC5rZXkgPT09ICdBcnJvd0xlZnQnKSB7XG5cdFx0XHRcdGxldCBkc3QgPSBldmVudC50YXJnZXQucHJldmlvdXNFbGVtZW50U2libGluZztcblx0XHRcdFx0d2hpbGUgKCFkc3QubWF0Y2hlcygnaW5wdXQubnVtJykpIHtcblx0XHRcdFx0XHRpZiAoZHN0LnByZXZpb3VzRWxlbWVudFNpYmxpbmcpXG5cdFx0XHRcdFx0XHRkc3QgPSBkc3QucHJldmlvdXNFbGVtZW50U2libGluZztcblx0XHRcdFx0XHRlbHNlXG5cdFx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdH1cblx0XHRcdFx0ZHN0LmZvY3VzKCk7XG5cdFx0XHRcdGRzdC5zZWxlY3Rpb25TdGFydCA9IGRzdC52YWx1ZS5sZW5ndGg7XG5cdFx0XHRcdGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHR9IGVsc2UgaWYgKHBvaW50ID09PSBldmVudC50YXJnZXQudmFsdWUubGVuZ3RoICYmIGV2ZW50LmtleSA9PT0gJ0Fycm93UmlnaHQnKSB7XG5cdFx0XHRcdGxldCBkc3QgPSBldmVudC50YXJnZXQubmV4dEVsZW1lbnRTaWJsaW5nO1xuXHRcdFx0XHR3aGlsZSAoIWRzdC5tYXRjaGVzKCdpbnB1dC5udW0nKSkge1xuXHRcdFx0XHRcdGlmIChkc3QubmV4dEVsZW1lbnRTaWJsaW5nKVxuXHRcdFx0XHRcdFx0ZHN0ID0gZHN0Lm5leHRFbGVtZW50U2libGluZztcblx0XHRcdFx0XHRlbHNlXG5cdFx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdH1cblx0XHRcdFx0ZHN0LmZvY3VzKCk7XG5cdFx0XHRcdGRzdC5zZWxlY3Rpb25FbmQgPSAwO1xuXHRcdFx0XHRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0fVxuXG5cdFx0fVxuXHR9XG5cblx0ZnVuY3Rpb24gb25ab25lV2hlZWwoZXZlbnQpIHtcblx0XHRpZiAoZXZlbnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnbnVtJykpIHtcblx0XHRcdGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRtb2RpZnlJbnB1dChldmVudC50YXJnZXQsIC1NYXRoLnNpZ24oZXZlbnQuZGVsdGFZKSk7XG5cdFx0fVxuXHR9XG5cblx0ZnVuY3Rpb24gYXBwbHlTZXR0aW5ncygpIHtcblx0XHRpZiAoc2V0dGluZ3NGb3JtRWwuaGlkZVNsaWRlcnMgJiYgc2V0dGluZ3NGb3JtRWwuaGlkZVNsaWRlcnMuY2hlY2tlZCkge1xuXHRcdFx0ZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QuYWRkKCdoaWRlLXNsaWRlcnMnKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0ZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QucmVtb3ZlKCdoaWRlLXNsaWRlcnMnKTtcblx0XHR9XG5cdH1cblxuLy8gfSk7XG5cbi8vIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdsb2FkJywgKCkgPT4ge1xuXHQvLyBGdXp6eSBzZWFyY2hpbmcgb2YgY2l0aWVzLlxuXHRkb2N1bWVudC5ib2R5LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIG9uS2V5RG93bik7XG5cdGRvY3VtZW50LmJvZHkuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldmVudCkgPT4ge1xuXHRcdGlmIChldmVudC50YXJnZXQuZ2V0QXR0cmlidXRlKFwiaHJlZlwiKSA9PT0gXCIjXCIgJiYgZXZlbnQudGFyZ2V0LmRhdGFzZXQudGltZXpvbmUpIHtcblx0XHRcdGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRhZGRUaW1lWmVuZUZyb21MaW5rKGV2ZW50LnRhcmdldCk7XG5cdFx0fVxuXHR9KTtcblxuXHRjb25zdCBjaXR5RGF0YSA9IFtdO1xuXHRsZXQgcHJldk5lZWRsZSA9IFwiXCI7XG5cdGxldCBwcmV2UmVzdWx0cyA9IFtdO1xuXHRsZXQgc2VhcmNoSWQgPSAwO1xuXG5cdGZldGNoKCdjaXRpZXM1MDAwLnR4dCcpXG5cdFx0LnRoZW4oKHJlc3BvbnNlKSA9PiByZXNwb25zZS50ZXh0KCkpXG5cdFx0LnRoZW4oKGNvbnRlbnQpID0+IHtcblx0XHRcdGNvbnN0IGxpbmVzID0gY29udGVudC5zcGxpdCgnXFxuJykuc2xpY2UoMik7XG5cdFx0XHRmb3IgKGNvbnN0IGxpbmUgb2YgbGluZXMpIHtcblx0XHRcdFx0aWYgKCFsaW5lKSB7XG5cdFx0XHRcdFx0Y29udGludWU7XG5cdFx0XHRcdH1cblx0XHRcdFx0Y29uc3QgW25hbWUsIGFzY2lpTmFtZSwgdGltZXpvbmVdID0gbGluZS5zcGxpdChcIlxcdFwiKTtcblx0XHRcdFx0Y2l0eURhdGEucHVzaCh7bmFtZSwgYXNjaWlOYW1lLCB0aW1lem9uZSwgbG93ZXJOYW1lOiBhc2NpaU5hbWUudG9Mb3dlckNhc2UoKX0pO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdGZ1bmN0aW9uIG9uS2V5RG93bihldmVudCkge1xuXHRcdGlmICghZXZlbnQudGFyZ2V0Lm1hdGNoZXMoXCJpbnB1dC56b25lLWlucHV0XCIpKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0aWYgKGV2ZW50LmtleSA9PT0gXCJBcnJvd1VwXCIpIHtcblx0XHRcdGNvbnN0IGFjdGl2ZUVsID0gZXZlbnQudGFyZ2V0LnByZXZpb3VzRWxlbWVudFNpYmxpbmcucXVlcnlTZWxlY3RvcihcIi5hY3RpdmVcIik7XG5cdFx0XHRpZiAoYWN0aXZlRWwucHJldmlvdXNFbGVtZW50U2libGluZykge1xuXHRcdFx0XHRhY3RpdmVFbC5jbGFzc0xpc3QucmVtb3ZlKFwiYWN0aXZlXCIpO1xuXHRcdFx0XHRhY3RpdmVFbC5wcmV2aW91c0VsZW1lbnRTaWJsaW5nLmNsYXNzTGlzdC5hZGQoXCJhY3RpdmVcIik7XG5cdFx0XHR9XG5cblx0XHR9IGVsc2UgaWYgKGV2ZW50LmtleSA9PT0gXCJBcnJvd0Rvd25cIikge1xuXHRcdFx0Y29uc3QgYWN0aXZlRWwgPSBldmVudC50YXJnZXQubmV4dEVsZW1lbnRTaWJsaW5nLnF1ZXJ5U2VsZWN0b3IoXCIuYWN0aXZlXCIpO1xuXHRcdFx0aWYgKGFjdGl2ZUVsLm5leHRFbGVtZW50U2libGluZykge1xuXHRcdFx0XHRhY3RpdmVFbC5jbGFzc0xpc3QucmVtb3ZlKFwiYWN0aXZlXCIpO1xuXHRcdFx0XHRhY3RpdmVFbC5uZXh0RWxlbWVudFNpYmxpbmcuY2xhc3NMaXN0LmFkZChcImFjdGl2ZVwiKTtcblx0XHRcdH1cblxuXHRcdH0gZWxzZSBpZiAoZXZlbnQua2V5ID09PSBcIkVudGVyXCIpIHtcblx0XHRcdGNvbnN0IGFjdGl2ZUVsID0gZXZlbnQudGFyZ2V0Lm5leHRFbGVtZW50U2libGluZy5xdWVyeVNlbGVjdG9yKFwiLmFjdGl2ZVwiKTtcblx0XHRcdGFkZFRpbWVaZW5lRnJvbUxpbmsoYWN0aXZlRWwpO1xuXG5cdFx0fSBlbHNlIHtcblx0XHRcdHNldFRpbWVvdXQoZG9TZWFyY2gpO1xuXG5cdFx0fVxuXG5cdFx0ZnVuY3Rpb24gZG9TZWFyY2goKSB7XG5cdFx0XHRjb25zdCB0aGlzU2VhcmNoSWQgPSArK3NlYXJjaElkO1xuXG5cdFx0XHRjb25zdCBuZWVkbGUgPSBldmVudC50YXJnZXQudmFsdWUudG9Mb3dlckNhc2UoKTtcblxuXHRcdFx0aWYgKG5lZWRsZSA9PT0gcHJldk5lZWRsZSkge1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cblx0XHRcdGNvbnN0IG1hdGNoZXMgPSBbXTtcblx0XHRcdHNldFRpbWVvdXQoZG9TZWFyY2gpO1xuXG5cdFx0XHRjb25zdCByZXN1bHRzID0gW107XG5cdFx0XHRmb3IgKGNvbnN0IGl0ZW0gb2YgKHByZXZOZWVkbGUgJiYgbmVlZGxlLmluY2x1ZGVzKHByZXZOZWVkbGUpID8gcHJldlJlc3VsdHMgOiBjaXR5RGF0YSkpIHtcblx0XHRcdFx0aWYgKGl0ZW0ubG93ZXJOYW1lLmluY2x1ZGVzKG5lZWRsZSkpIHtcblx0XHRcdFx0XHRyZXN1bHRzLnB1c2goaXRlbSk7XG5cdFx0XHRcdFx0bWF0Y2hlcy5wdXNoKGA8YSBocmVmPSMgZGF0YS10aW1lem9uZT1cIiR7aXRlbS50aW1lem9uZX1cIiBjbGFzcz1cIiR7bWF0Y2hlcy5sZW5ndGggPyBcIlwiIDogXCJhY3RpdmVcIn1cIj4ke2l0ZW0ubmFtZX08L2E+YCk7XG5cdFx0XHRcdH1cblx0XHRcdFx0aWYgKHRoaXNTZWFyY2hJZCAhPT0gc2VhcmNoSWQpIHtcblx0XHRcdFx0XHRjb25zb2xlLmxvZyhcIkNhbmNlbCBzZWFyY2hcIiwgdGhpc1NlYXJjaElkKTtcblx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0aWYgKHRoaXNTZWFyY2hJZCA9PT0gc2VhcmNoSWQpIHtcblx0XHRcdFx0cHJldlJlc3VsdHMgPSByZXN1bHRzO1xuXHRcdFx0XHRldmVudC50YXJnZXQubmV4dEVsZW1lbnRTaWJsaW5nLmlubmVySFRNTCA9IG1hdGNoZXMuam9pbihcIlwiKTtcblx0XHRcdH1cblx0XHR9XG5cblx0fVxuXG5cdGZ1bmN0aW9uIGFkZFRpbWVaZW5lRnJvbUxpbmsoZWwpIHtcblx0XHRhZGRab25lKGVsLmRhdGFzZXQudGltZXpvbmUpO1xuXHRcdHNhdmVab25lcygpO1xuXHR9XG59KTtcblxuZnVuY3Rpb24gcm91bmRlZFRvMTUobXQpIHtcblx0aWYgKG10IGluc3RhbmNlb2YgbW9tZW50KSB7XG5cdFx0Y29uc3QgbW9kID0gbXQuc2Vjb25kKDApLm1pbnV0ZSgpICUgMTU7XG5cdFx0aWYgKG1vZCA+PSA4KVxuXHRcdFx0bXQuYWRkKDE1LCAnbScpO1xuXHRcdHJldHVybiBtdC5zdWJ0cmFjdChtb2QsICdtJyk7XG5cdH0gZWxzZSB7XG5cdFx0bXQgPSBNYXRoLnJvdW5kKHBhcnNlRmxvYXQobXQpKTtcblx0XHRjb25zdCBtb2QgPSBtdCAlIDE1O1xuXHRcdGlmIChtb2QgPj0gOClcblx0XHRcdG10ICs9IDE1O1xuXHRcdHJldHVybiBtdCAtIG1vZDtcblx0fVxufVxuXG5mdW5jdGlvbiBnZXRNb21lbnRJblpvbmVCb3goem9uZUVsKSB7XG5cdHJldHVybiBtb21lbnQudHooW1xuXHRcdHpvbmVFbC55ZWFyLnZhbHVlLFxuXHRcdHpvbmVFbC5tb250aC52YWx1ZSxcblx0XHR6b25lRWwuZGF0ZS52YWx1ZSxcblx0XHR6b25lRWwuaG91ci52YWx1ZSxcblx0XHR6b25lRWwubWludXRlLnZhbHVlLFxuXHRcdHpvbmVFbC5tZXJpZGlhbi52YWx1ZSxcblx0XS5qb2luKCcgJyksICdZWVlZIE1NIEREIGhoIG1tIEEnLCB6b25lRWwuZGF0YXNldC56b25lKTtcbn1cblxuZnVuY3Rpb24gc2V0TW9tZW50SW5ab25lQm94KHpvbmVFbCwgbXQsIGV4Y2VwdElucHV0cykge1xuXHRjb25zdCBbeWVhciwgbW9udGgsIGRhdGUsIGhvdXIsIG1pbnV0ZSwgbWVyaWRpYW4sIGFiYnIsIG9mZnNldF0gPVxuXHRcdG10LmZvcm1hdCgnWVlZWSBNTSBERCBoaCBtbSBBIHp6IFpaJykuc3BsaXQoJyAnKTtcblxuXHRpZiAoIWV4Y2VwdElucHV0cyB8fCAhZXhjZXB0SW5wdXRzLmluY2x1ZGVzKHpvbmVFbC55ZWFyKSlcblx0XHR6b25lRWwueWVhci52YWx1ZSA9IHllYXI7XG5cblx0aWYgKCFleGNlcHRJbnB1dHMgfHwgIWV4Y2VwdElucHV0cy5pbmNsdWRlcyh6b25lRWwubW9udGgpKVxuXHRcdHpvbmVFbC5tb250aC52YWx1ZSA9IG1vbnRoO1xuXG5cdGlmICghZXhjZXB0SW5wdXRzIHx8ICFleGNlcHRJbnB1dHMuaW5jbHVkZXMoem9uZUVsLmRhdGUpKVxuXHRcdHpvbmVFbC5kYXRlLnZhbHVlID0gZGF0ZTtcblxuXHRpZiAoIWV4Y2VwdElucHV0cyB8fCAhZXhjZXB0SW5wdXRzLmluY2x1ZGVzKHpvbmVFbC5ob3VyKSlcblx0XHR6b25lRWwuaG91ci52YWx1ZSA9IGhvdXI7XG5cblx0aWYgKCFleGNlcHRJbnB1dHMgfHwgIWV4Y2VwdElucHV0cy5pbmNsdWRlcyh6b25lRWwubWludXRlKSlcblx0XHR6b25lRWwubWludXRlLnZhbHVlID0gbWludXRlO1xuXG5cdGlmICghZXhjZXB0SW5wdXRzIHx8ICFleGNlcHRJbnB1dHMuaW5jbHVkZXMoem9uZUVsLm1lcmlkaWFuKSlcblx0XHR6b25lRWwubWVyaWRpYW4udmFsdWUgPSBtZXJpZGlhbjtcblxuXHR6b25lRWwucXVlcnlTZWxlY3RvcignLnR6LWFiYnInKS5pbm5lckhUTUwgPSBhYmJyID09IHpvbmVFbC5kYXRhc2V0LnpvbmUgPyAnJyA6IChhYmJyICsgJyA9IFVUQycgKyBvZmZzZXQpO1xufVxuXG5mdW5jdGlvbiBzYXZlWm9uZXMoKSB7XG5cdGNvbnN0IG5hbWVzID0gW107XG5cdGZvciAoY29uc3QgZWwgb2Ygem9uZXNFbC5jaGlsZHJlbilcblx0XHRuYW1lcy5wdXNoKGVsLmRhdGFzZXQuem9uZSk7XG5cdGxvY2FsU3RvcmFnZS5zZXRJdGVtKCd6b25lcycsIEpTT04uc3RyaW5naWZ5KG5hbWVzLnNsaWNlKDEpKSk7XG59XG5cbmZ1bmN0aW9uIGxvYWRab25lcygpIHtcblx0Y29uc3Qgc3RvcmFnZSA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd6b25lcycpO1xuXHRpZiAoIXN0b3JhZ2UpXG5cdFx0cmV0dXJuIERFRkFVTFRfWk9ORVM7XG5cdGNvbnN0IG5hbWVzID0gSlNPTi5wYXJzZShzdG9yYWdlKTtcblx0aWYgKCFuYW1lcyB8fCBuYW1lcy5sZW5ndGggPT09IDApXG5cdFx0cmV0dXJuIERFRkFVTFRfWk9ORVM7XG5cdHJldHVybiBuYW1lcztcbn1cblxuZnVuY3Rpb24gbG9hZEFsbFRpbWVab25lcygpIHtcblx0Y29uc3QgbmFtZXMgPSBtb21lbnQudHoubmFtZXMoKTtcblx0Zm9yIChsZXQgaSA9IG5hbWVzLmxlbmd0aDsgaS0tID4gMDspXG5cdFx0bmFtZXNbaV0gPSAnPG9wdGlvbiB2YWx1ZT1cIicgKyBuYW1lc1tpXSArICdcIj4nO1xuXHRkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnem9uZU5hbWVzJykuaW5uZXJIVE1MID0gbmFtZXMuam9pbignJyk7XG59XG4iLCJ3aW5kb3cub25sb2FkID0gbWFpbjtcblxubGV0IGg7IC8vIFNldCB0byBgaHlwZXJhcHAuaGAgd2hlbiBoeXBlcmFwcCBpcyBsb2FkZWQuXG5cbmZ1bmN0aW9uIG1haW4oKSB7XG5cdGggPSBoeXBlcmFwcC5oO1xuXG5cdGNvbnN0IHthcHB9ID0gaHlwZXJhcHA7XG5cblx0d2luZG93LmhhID0gYXBwKHtcblxuXHRcdGluaXQ6IFtcblx0XHRcdHtcblx0XHRcdFx0Y3VycmVudFV0YzogbnVsbCxcblxuXHRcdFx0XHRjaXRpZXM6IFtcblx0XHRcdFx0XHRcIk11bWJhaVwiLFxuXHRcdFx0XHRcdFwiTG9uZG9uXCIsXG5cdFx0XHRcdFx0XCJOZXcgWW9ya1wiLFxuXHRcdFx0XHRcdFwiU3lkbmV5XCIsXG5cdFx0XHRcdF0sXG5cblx0XHRcdFx0Ly8gWm9uZSBvYmplY3RzIGJ5IGNpdHksIGRhdGEgbG9hZGVkIG9uIGFwcCBzdGFydC5cblx0XHRcdFx0em9uZXNCeUNpdHk6IG5ldyBNYXAoKSxcblxuXHRcdFx0XHR0aW1lc0J5Wm9uZTogbmV3IE1hcCgpLFxuXG5cdFx0XHRcdGlucHV0VmFsdWU6IFwiXCIsXG5cdFx0XHR9LFxuXHRcdFx0W2xvYWRDaXRpZXMvKiwgb3B0aW9ucyovXSxcblx0XHRdLFxuXG5cdFx0bm9kZTogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJhcHBcIiksXG5cblx0XHR2aWV3KHN0YXRlKSB7XG5cdFx0XHRyZXR1cm4gaChcImRpdlwiLCB7fSwgW1xuXHRcdFx0XHRoKFwiaDFcIiwge30sIFwifiBUaW1lem9uZXIgfiBcIiksXG5cdFx0XHRcdGgoXCJzZWN0aW9uXCIsIHt9LCBbXG5cdFx0XHRcdFx0aChcImRpdlwiLCB7fSwgem9uZURpc3BsYXlGb3JDaXR5KHN0YXRlKSksXG5cdFx0XHRcdFx0aChcImlucHV0XCIsIHtcblx0XHRcdFx0XHRcdHZhbHVlOiBzdGF0ZS5pbnB1dFZhbHVlLFxuXHRcdFx0XHRcdFx0b25rZXlkb3duOiAoc3RhdGUsIGV2ZW50KSA9PiB7XG5cdFx0XHRcdFx0XHRcdHJldHVybiBldmVudC5rZXkgPT09IFwiRW50ZXJcIiA/IGFkZChzdGF0ZSkgOiBzdGF0ZTtcblx0XHRcdFx0XHRcdH0sXG5cdFx0XHRcdFx0XHRvbmlucHV0OiAoKHN0YXRlLCBldmVudCkgPT4ge1xuXHRcdFx0XHRcdFx0XHRyZXR1cm4gey4uLnN0YXRlLCBpbnB1dFZhbHVlOiBldmVudC50YXJnZXQudmFsdWV9O1xuXHRcdFx0XHRcdFx0fSksXG5cdFx0XHRcdFx0fSksXG5cdFx0XHRcdFx0aChcImJ1dHRvblwiLCB7b25jbGljazogYWRkfSwgXCJhZGRcIiksXG5cdFx0XHRcdF0pLFxuXHRcdFx0XSk7XG5cdFx0fSxcblxuXHR9KTtcblxuXHRmdW5jdGlvbiBhZGQoc3RhdGUpIHtcblx0XHRpZiAoc3RhdGUuaW5wdXRWYWx1ZSAhPT0gXCJcIikge1xuXHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0Li4uc3RhdGUsXG5cdFx0XHRcdGNpdGllczogWy4uLnN0YXRlLmNpdGllcywgc3RhdGUuaW5wdXRWYWx1ZV0sXG5cdFx0XHRcdGlucHV0VmFsdWU6IFwiXCIsXG5cdFx0XHR9O1xuXHRcdH1cblx0XHRyZXR1cm4gc3RhdGU7XG5cdH1cblxufVxuXG5mdW5jdGlvbiBsb2FkQ2l0aWVzKGRpc3BhdGNoLyosIG9wdGlvbnMqLykge1xuXHRmZXRjaCgnY2l0aWVzNTAwMC50eHQnKVxuXHRcdC50aGVuKChyZXNwb25zZSkgPT4gcmVzcG9uc2UudGV4dCgpKVxuXHRcdC50aGVuKChjb250ZW50KSA9PiB7XG5cdFx0XHRjb25zdCB6b25lc0J5Q2l0eSA9IG5ldyBNYXA7XG5cdFx0XHRjb25zdCBsaW5lcyA9IGNvbnRlbnQuc3BsaXQoJ1xcbicpLnNsaWNlKDIpO1xuXHRcdFx0Zm9yIChjb25zdCBsaW5lIG9mIGxpbmVzKSB7XG5cdFx0XHRcdGlmIChsaW5lKSB7XG5cdFx0XHRcdFx0Y29uc3QgW25hbWUsIGFzY2lpTmFtZSwgdGltZXpvbmVdID0gbGluZS5zcGxpdChcIlxcdFwiKTtcblx0XHRcdFx0XHR6b25lc0J5Q2l0eS5zZXQobmFtZSwge25hbWUsIGFzY2lpTmFtZSwgdGltZXpvbmUsIGxvd2VyTmFtZTogYXNjaWlOYW1lLnRvTG93ZXJDYXNlKCl9KTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0ZGlzcGF0Y2goKHN0YXRlKSA9PiB7XG5cdFx0XHRcdHJldHVybiB7Li4uc3RhdGUsIHpvbmVzQnlDaXR5fTtcblx0XHRcdH0pO1xuXHRcdH0pO1xufVxuXG5mdW5jdGlvbiB6b25lRGlzcGxheUZvckNpdHkoc3RhdGUpIHtcblx0cmV0dXJuIHN0YXRlLmNpdGllcy5tYXAoKG5hbWUpID0+IHtcblx0XHRjb25zdCB6b25lID0gc3RhdGUuem9uZXNCeUNpdHkuZ2V0KG5hbWUpO1xuXHRcdGlmICghem9uZSkge1xuXHRcdFx0cmV0dXJuIFwiXCI7XG5cdFx0fVxuXG5cdFx0Y29uc3QgdGltZSA9IHN0YXRlLnRpbWVzQnlab25lLmdldCh6b25lLnRpbWV6b25lcyk7XG5cblx0XHRyZXR1cm4gaChcImZvcm1cIiwge2NsYXNzOiBcInpvbmVcIiwgXCJkYXRhLXpvbmVcIjogem9uZS50aW1lem9uZX0sIFtcblx0XHRcdGgoXCJkaXZcIiwge2NsYXNzOiBcIm5hbWVcIn0sIG5hbWUpLFxuXHRcdFx0XCIgLSBcIixcblx0XHRcdHpvbmUgPyB6b25lLnRpbWV6b25lIDogXCJObyB6b25lXCIsXG5cdFx0XHRcIiAtIFwiLFxuXHRcdFx0aChcImlucHV0XCIsIHtjbGFzczogXCJudW1cIiwgcmVxdWlyZWQ6IHRydWUsIG5hbWU6IFwieWVhclwiLCB2YWx1ZTogdGltZS55ZWFyfSksXG5cdFx0XHRcIi1cIixcblx0XHRcdGgoXCJpbnB1dFwiLCB7Y2xhc3M6IFwibnVtXCIsIHJlcXVpcmVkOiB0cnVlLCBuYW1lOiBcIm1vbnRoXCIsIHZhbHVlOiB0aW1lLm1vbnRofSksXG5cdFx0XHRcIi1cIixcblx0XHRcdGgoXCJpbnB1dFwiLCB7Y2xhc3M6IFwibnVtXCIsIHJlcXVpcmVkOiB0cnVlLCBuYW1lOiBcImRhdGVcIiwgdmFsdWU6IHRpbWUuZGF0ZX0pLFxuXHRcdFx0XCIgIFwiLFxuXHRcdFx0aChcImlucHV0XCIsIHtjbGFzczogXCJudW1cIiwgcmVxdWlyZWQ6IHRydWUsIG5hbWU6IFwiaG91clwiLCB2YWx1ZTogdGltZS5ob3VyfSksXG5cdFx0XHRcIjpcIixcblx0XHRcdGgoXCJpbnB1dFwiLCB7Y2xhc3M6IFwibnVtXCIsIHJlcXVpcmVkOiB0cnVlLCBuYW1lOiBcIm1pbnV0ZVwiLCB2YWx1ZTogdGltZS5taW51dGV9KSxcblx0XHRcdFwiIFwiLFxuXHRcdFx0aChcImlucHV0XCIsIHtjbGFzczogXCJudW1cIiwgcmVxdWlyZWQ6IHRydWUsIG5hbWU6IFwibWVyaWRpYW5cIiwgdmFsdWU6IHRpbWUubWVyaWRpYW59KSxcblx0XHRdKTtcblx0fSk7XG59XG4iXX0=